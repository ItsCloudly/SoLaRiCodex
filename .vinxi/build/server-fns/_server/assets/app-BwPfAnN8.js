import{createComponent as f,isServer as P,getRequestEvent as O,delegateEvents as T}from"solid-js/web";import{F as j}from"./server-fns-Dk2UlWmY.js";import{children as q,createMemo as L,getOwner as x,untrack as B,Show as U,on as D,createRoot as N,createSignal as K,onCleanup as F,sharedConfig as y,Suspense as W}from"solid-js";import{c as V,d as _,R as H,g as J,e as M,f as k,h as z,m as G,k as Q,s as X,i as Y,j as Z}from"./components-YnJA_VXq.js";import"cookie-es";import"seroval";import"seroval-plugins/web";import"solid-js/web/storage";import"h3";import"unctx";import"node:async_hooks";import"radix3";const I=t=>n=>{const{base:o}=n,r=q(()=>n.children),e=L(()=>V(r(),n.base||""));let s;const u=_(t,e,()=>s,{base:o,singleFlight:n.singleFlight,transformUrl:n.transformUrl});return t.create&&t.create(u),f(H.Provider,{value:u,get children(){return f($,{routerState:u,get root(){return n.root},get preload(){return n.rootPreload||n.rootLoad},get children(){return[(s=x())&&null,f(tt,{routerState:u,get branches(){return e()}})]}})}})};function $(t){const n=t.routerState.location,o=t.routerState.params,r=L(()=>t.preload&&B(()=>{t.preload({params:o,location:n,intent:J()||"initial"})}));return f(U,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:e=>f(e,{params:o,location:n,get data(){return r()},get children(){return t.children}})})}function tt(t){if(P){const e=O();if(e&&e.router&&e.router.dataOnly){et(e,t.routerState,t.branches);return}e&&((e.router||(e.router={})).matches||(e.router.matches=t.routerState.matches().map(({route:s,path:u,params:m})=>({path:s.originalPath,pattern:s.pattern,match:u,params:m,info:s.info}))))}const n=[];let o;const r=L(D(t.routerState.matches,(e,s,u)=>{let m=s&&e.length===s.length;const h=[];for(let l=0,w=e.length;l<w;l++){const b=s&&s[l],g=e[l];u&&b&&g.route.key===b.route.key?h[l]=u[l]:(m=!1,n[l]&&n[l](),N(R=>{n[l]=R,h[l]=M(t.routerState,h[l-1]||t.routerState.base,C(()=>r()[l+1]),()=>t.routerState.matches()[l])}))}return n.splice(e.length).forEach(l=>l()),u&&m?u:(o=h[0],h)}));return C(()=>r()&&o)()}const C=t=>()=>f(U,{get when(){return t()},keyed:!0,children:n=>f(z.Provider,{value:n,get children(){return n.outlet()}})});function et(t,n,o){const r=new URL(t.request.url),e=k(o,new URL(t.router.previousUrl||t.request.url).pathname),s=k(o,r.pathname);for(let u=0;u<s.length;u++){(!e[u]||s[u].route!==e[u].route)&&(t.router.dataOnly=!0);const{route:m,params:h}=s[u];m.preload&&m.preload({params:h,location:n.location,intent:"preload"})}}function nt([t,n],o,r){return[t,r?e=>n(r(e)):n]}function rt(t){let n=!1;const o=e=>typeof e=="string"?{value:e}:e,r=nt(K(o(t.get()),{equals:(e,s)=>e.value===s.value&&e.state===s.state}),void 0,e=>(!n&&t.set(e),y.registry&&!y.done&&(y.done=!0),e));return t.init&&F(t.init((e=t.get())=>{n=!0,r[1](o(e)),n=!1})),I({signal:r,create:t.create,utils:t.utils})}function ot(t,n,o){return t.addEventListener(n,o),()=>t.removeEventListener(n,o)}function at(t,n){const o=t&&document.getElementById(t);o?o.scrollIntoView():n&&window.scrollTo(0,0)}function it(t){const n=new URL(t);return n.pathname+n.search}function st(t){let n;const o={value:t.url||(n=O())&&it(n.request.url)||""};return I({signal:[()=>o,r=>Object.assign(o,r)]})(t)}const ut=new Map;function ct(t=!0,n=!1,o="/_server",r){return e=>{const s=e.base.path(),u=e.navigatorFactory(e.base);let m,h;function l(a){return a.namespaceURI==="http://www.w3.org/2000/svg"}function w(a){if(a.defaultPrevented||a.button!==0||a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)return;const i=a.composedPath().find(A=>A instanceof Node&&A.nodeName.toUpperCase()==="A");if(!i||n&&!i.hasAttribute("link"))return;const d=l(i),c=d?i.href.baseVal:i.href;if((d?i.target.baseVal:i.target)||!c&&!i.hasAttribute("state"))return;const p=(i.getAttribute("rel")||"").split(/\s+/);if(i.hasAttribute("download")||p&&p.includes("external"))return;const v=d?new URL(c,document.baseURI):new URL(c);if(!(v.origin!==window.location.origin||s&&v.pathname&&!v.pathname.toLowerCase().startsWith(s.toLowerCase())))return[i,v]}function b(a){const i=w(a);if(!i)return;const[d,c]=i,E=e.parsePath(c.pathname+c.search+c.hash),p=d.getAttribute("state");a.preventDefault(),u(E,{resolve:!1,replace:d.hasAttribute("replace"),scroll:!d.hasAttribute("noscroll"),state:p?JSON.parse(p):void 0})}function g(a){const i=w(a);if(!i)return;const[d,c]=i;r&&(c.pathname=r(c.pathname)),e.preloadRoute(c,d.getAttribute("preload")!=="false")}function R(a){clearTimeout(m);const i=w(a);if(!i)return h=null;const[d,c]=i;h!==d&&(r&&(c.pathname=r(c.pathname)),m=setTimeout(()=>{e.preloadRoute(c,d.getAttribute("preload")!=="false"),h=d},20))}function S(a){if(a.defaultPrevented)return;let i=a.submitter&&a.submitter.hasAttribute("formaction")?a.submitter.getAttribute("formaction"):a.target.getAttribute("action");if(!i)return;if(!i.startsWith("https://action/")){const c=new URL(i,G);if(i=e.parsePath(c.pathname+c.search),!i.startsWith(o))return}if(a.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const d=ut.get(i);if(d){a.preventDefault();const c=new FormData(a.target,a.submitter);d.call({r:e,f:a.target},a.target.enctype==="multipart/form-data"?c:new URLSearchParams(c))}}T(["click","submit"]),document.addEventListener("click",b),t&&(document.addEventListener("mousemove",R,{passive:!0}),document.addEventListener("focusin",g,{passive:!0}),document.addEventListener("touchstart",g,{passive:!0})),document.addEventListener("submit",S),F(()=>{document.removeEventListener("click",b),t&&(document.removeEventListener("mousemove",R),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",S)})}}function lt(t){if(P)return st(t);const n=()=>{const r=window.location.pathname.replace(/^\/+/,"/")+window.location.search,e=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:r+window.location.hash,state:e}},o=Y();return rt({get:n,set({value:r,replace:e,scroll:s,state:u}){e?window.history.replaceState(Q(u),"",r):window.history.pushState(u,"",r),at(decodeURIComponent(window.location.hash.slice(1)),s),X()},init:r=>ot(window,"popstate",Z(r,e=>{if(e&&e<0)return!o.confirm(e);{const s=n();return!o.confirm(s.value,{state:s.state})}})),create:ct(t.preload,t.explicitLinks,t.actionBase,t.transformUrl),utils:{go:r=>window.history.go(r),beforeLeave:o}})(t)}function St(){return f(lt,{root:t=>f(W,{get children(){return t.children}}),get children(){return f(j,{})}})}export{St as default};
